print(nrow(topCLust_wine_Rec))
if (nrow(topCLust_wine_Rec) >= 2) {break}
}
print(topClust_wine$Var1 )
print(topCLust_wine_Rec$Var1 )
print(paste("Run k-means using ",10, ", and ", topCLust_wine_Rec$Var1 )
print(paste("Run k-means using ",10, ", and ", topCLust_wine_Rec$Var1 ))
print(paste("Run k-means using ",10, ", and ", topCLust_wine_Rec$Var1 ))
Print(paste("RUn K-means for ", topCLust_wine_Rec$Var1 ))
print(paste("RUn K-means for ", topCLust_wine_Rec$Var1 ))
print(topCLust_wine_Rec$Var1 )
print(paste("Run k-means using 10, the number of actual Quality groups.  Additionally run k-means with cluster sizes..."
print(topCLust_wine_Rec$Var1 )
print(paste("Run k-means using 10, the number of actual Quality groups.  Additionally run k-means with cluster sizes..."))
print(topCLust_wine_Rec$Var1 )
View(wine_train)
k_wine_10 <- kmeans(wine_train, 10)
aggregate(wine_train,by=list(k_wine_10$cluster),FUN=mean)
table(wine_train,by=list(k_wine_10$cluster)
table(wine_train, k_wine_10$cluster)
table(k_wine_10$cluster)
table(k_wine_10$cluster, wine[12])
length(k_wine_10$cluster)
table(k_wine_10$cluster, wine[,12])
k_wine_1 <- kmeans(wine_train, topCLust_wine_Rec$Var1[1])
table(k_wine_1$cluster, wine[,12])
k_wine_1 <- kmeans(wine_train, topCLust_wine_Rec$Var1[2])
table(k_wine_2$cluster, wine[,12])
k_wine_10 <- kmeans(wine_train, 10)
k_wine_1 <- kmeans(wine_train, topCLust_wine_Rec$Var1[1])
k_wine_2 <- kmeans(wine_train, topCLust_wine_Rec$Var1[2])
table(k_wine_10$cluster, wine[,12])
table(k_wine_1$cluster, wine[,12])
table(k_wine_2$cluster, wine[,12])
table(wine[,12])
table(k_wine_10$cluster, wine[,12], rowMeans())
table(k_wine_10$cluster, wine[,12], labels("10 clusters to 10 ACtual"))
wk <- loadWorkbook("C:\\Users\\onyxr\\Dropbox (Personal)\\School\\UW\\Data Mining\\Data Mining Coursework\\whitewine.xlsx")
wine <- readWorksheet(wk, sheet="White Wine")
table(wine[,-12])
table(wine[,12])
rm(list = ls())
wk <- loadWorkbook("C:\\Users\\onyxr\\Dropbox (Personal)\\School\\UW\\Data Mining\\Data Mining Coursework\\whitewine.xlsx")
wine <- readWorksheet(wk, sheet="White Wine")
str(wine)
qual_levels <- c(1:10)
wine$quality	<-factor(wine$quality, levels = qual_levels, ordered = TRUE)
str(wine)
wine_quality <- wine_$quality
qual_levels <- c(1:10)
wine$quality	<-factor(wine$quality, levels = qual_levels, ordered = TRUE)
wine_quality <- wine$quality
str(wine_train)
wine_train <- wine[,-12]
wine_train <- scale(wine_train)
str(wine_train)
head(wine_train)
head(wine)
?scale
c(1:10)
r<- c(1:10)
scale(r)
r<- c(1:20)
scale(r)
r<- append(100)
r<- rbind(100)
r
r<- c(1:20)
r<- c(1:20, 100)
r
scale(r)
r<- c(1:20, 1000)
scale(r)
lentgh(r)
length(r)
sd(r)
(1000-21)/sd(r)
mean(r)
(1000-mean(r) )/sd(r)
head(wine_train)
str(wine_train)
class(wine_train)
class(wine)
a_wine <- scale(wine)
a_wine <- scale(wine[,-12])
install.packages("tictoc")
require("tictoc")
?tictoc
tic
scale(r)
toc
tic()
scale(r)
toc()
tic()
scale(r)
t <- toc()
t
tic("total")
scale(r)
t <- toc()
t
class(t)
str(t)
tic()
numClust_wine <- NbClust(wine_train, method = "kmeans", min.nc =  2, max.nc = 15)
t_clust<- toc()
numClust_wine
table(numClust_wine$Best.n[,1])
table(numClust_wine$Best.n[1,])
table(numClust_wine$Best.n[1,])
numClust_wine$Best.n[1,]
table(numClust_wine$Best.n[1,])
recClust_wine <-data.frame(table(numClust_wine$Best.n[1,]))
str(recClust_wine)
recClust_wine$Var1 <- as.integer(recClust_wine$Var1)
str(recClust_wine)
recClust_wine
recClust_wine <-data.frame(table(numClust_wine$Best.n[1,]))
recClust_wine$Var1 <- as.numeric(recClust_wine$Var1)
str(recClust_wine)
recClust_wine$Var1 <- as.numeric(levels(recClust_wine$Var1))
as.numeric(levels(recClust_wine$Var1))
recClust_wine$Var1 <- as.integer(recClust_wine$Var1)
topCLust_wine_Rec = as.data.frame(NULL)
print(paste("Run k-means using 10, the number of actual Quality groups.  Additionally run k-means with cluster sizes..."))
print(topCLust_wine_Rec$Var1 )
repeat {
topCLust_wine_Rec <- rbind(topCLust_wine_Rec, recClust_wine[recClust_wine$Freq == max(recClust_wine$Freq),])
recClust_wine <- recClust_wine[!recClust_wine$Freq == max(recClust_wine$Freq),]
print(nrow(topCLust_wine_Rec))
if (nrow(topCLust_wine_Rec) >= 2) {break}
}
topCLust_wine_Rec = data.frame()
recClust_wine <-data.frame(table(numClust_wine$Best.n[1,]))
str(recClust_wine)
recClust_wine$Var1 <- as.integer(recClust_wine$Var1)
#find the two most strongly recomended cluster sizes (based on index count)
topCLust_wine_Rec = data.frame()
repeat {
topCLust_wine_Rec <- rbind(topCLust_wine_Rec, recClust_wine[recClust_wine$Freq == max(recClust_wine$Freq),])
recClust_wine <- recClust_wine[!recClust_wine$Freq == max(recClust_wine$Freq),]
print(nrow(topCLust_wine_Rec))
if (nrow(topCLust_wine_Rec) >= 2) {break}
}
print(paste("Run k-means using 10, the number of actual Quality groups.  Additionally run k-means with cluster sizes..."))
print(topCLust_wine_Rec$Var1 )
k_wine_10 <- kmeans(wine_train, 10)
k_wine_1 <- kmeans(wine_train, topCLust_wine_Rec$Var1[1])
k_wine_2 <- kmeans(wine_train, topCLust_wine_Rec$Var1[2])
table(wine[,12])
table(k_wine_10$cluster, wine[,12])
table(k_wine_1$cluster, wine[,12])
table(k_wine_2$cluster, wine[,12])
table(wine[,12])
table(k_wine_1$cluster, wine[,12])
table(k_wine_2$cluster, wine[,12])
names(wine)
library(DBI)
library(odbc)
driver = "ODBC Driver 13 for SQL Server"
server = "advr.database.windows.net"
database = "advr"
uid = "lockedata"
pwd = "zll+.?=g8JA11111"
dbConn <- dbConnect(odbc(), driver = driver, server = server, database = database,
uid = uid, pwd = pwd)
install.packages("DBI")
install.packages("DBI")
install.packages("odbc")
clust_mtcars <- hclust(dist_mtcars, method = "complete")
library(odbc)plot(clust_mtcars, main = "Hierarchical clustering for mtcars dataset")
summary(iris)rect.hclust(clust_mtcars, k=3, border = "red")
iris <- dbReadTable(dbConn, "chicagofood.csv")
require(DBI)
require(odbc)
driver = "ODBC Driver 13 for SQL Server"
server = "advr.database.windows.net"
database = "advr"
uid = "lockedata"
pwd = "zll+.?=g8JA11111"
dbConn <- dbConnect(odbc(), driver = driver, server = server, database = database,
uid = uid, pwd = pwd)
iris <- dbReadTable(dbConn, "chicagofood.csv")
summary(iris)
iris <- dbReadTable(dbConn, "chicagofood")
head(iris)
rm(list=list())
rm(list=list()install.packages("DBI")
install.packages("odbc")
require(DBI)
require(odbc)
driver = "ODBC Driver 13 for SQL Server"
server = "advr.database.windows.net"
database = "advr"
uid = "lockedata"
pwd = "zll+.?=g8JA11111"
dbConn <- dbConnect(odbc(), driver = driver, server = server, database = database,
uid = uid, pwd = pwd)
iris <- dbReadTable(dbConn, "chicagofood")
summary(iris))
install.packages("odbc")
require(odbc)
str(wine_train)
str(wine_train)
temp$hclust_sing <- temp1$
str(temp)
ls()
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
str(wine)
#Convert the Quality variable into an Ordinal Factor
qual_levels <- c(1:10)
wine$quality	<-factor(wine$quality, levels = qual_levels, ordered = TRUE)
#view the distribution of Quality in the existing dataset
ggplot(wine, aes(x = quality)) +
geom_bar()
#isolate the quality columns
wine_quality <- wine$quality
#scale the data set
wine_train <- wine[,-12]
wine_train <- as.data.frame(scale(wine_train))
paste(
c("Run k-means using 7, the number of represented Quality groups.  Additionally run k-means with the following cluster sizes"
, topClust_Wine_Rec[1]
, topClust_Wine_Rec[2] ), collapse = ", ")
#find recommendation for best number of clusters
tic()
numClust_wine <- NbClust(wine_train, method = "kmeans", min.nc =  2, max.nc = 7)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#find recommendation for best number of clusters
tic()
numClust_wine <- NbClust(wine_train, method = "kmeans", min.nc =  2, max.nc = 7)
beep()
#store duration of NBClust
t_clust<- toc()
t_clust
#numClust_wine$Best.n[1,] stores a list of the number clusters recommended by each index
#find the top two (mode) wine cluster recommendations
topClust_Wine_Rec <- as.numeric(names(sort(-table(numClust_wine$Best.n[1,])))[1:2])
topClust_Wine_Rec
paste(
c("Run k-means using 7, the number of represented Quality groups.  Additionally run k-means with the following cluster sizes"
, topClust_Wine_Rec[1]
, topClust_Wine_Rec[2] ), collapse = ", ")
k_wine_10 <- kmeans(wine_train, 7)
k_wine_1 <- kmeans(wine_train, topClust_Wine_Rec[1])
k_wine_2 <- kmeans(wine_train, topClust_Wine_Rec[2])
tbwine <- table(wine[,12])
tb_ct_10 <- table(k_wine_10$cluster, wine[,12])
tb_ct_1 <- table(k_wine_1$cluster, wine[,12])
tb_ct_2 <- table(k_wine_2$cluster, wine[,12])
randIndex(tb_ct_10)
randIndex(tb_ct_1)
randIndex(tb_ct_2)
#hclust (agglomerative) single
hclust_sing <- hclust( dist(wine_train), method= "single")
dend_sing <- as.dendrogram(hclust_sing)
#hclust complete
hclust_compl <- hclust( dist(wine_train), method= "complete")
dend_compl <- as.dendrogram(hclust_compl)
#hclustaverage methods
hclust_avg <- hclust( dist(wine_train), method= "average")
dend_avg <- as.dendrogram(hclust_avg)
#Create dendogram visualization of all 3
layout(matrix(c(1:3),1,3))
plot(hclust_sing)
plot(hclust_compl)
plot(hclust_avg)
#cut the dendrograms and bind them to the wine_train dataset
wine_train$hclust_sing <- as.factor(
cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
wine_train$hclust_compl <- as.factor(
cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
wine_train$hclust_avg <- as.factor(
cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
str(wine_train)
temp$hclust_sing <- temp1$
str(temp)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#cut the dendrograms and bind them to the wine_train dataset
wine_train$hclust_sing <- as.factor(
cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
wine_train$hclust_compl <- as.factor(
cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
wine_train$hclust_avg <- as.factor(
cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
str(wine_train)
cutclust_compl <- cutree(hclust_compl, k= 1:10)
cutclust_avg <- cutree(hclust_avg, k= 1:10)
plot(cutclust_sing)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#cut the dendrograms and bind them to the wine_train dataset
wine_train$hclust_sing <- as.factor(
cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
wine_train$hclust_compl <- as.factor(
cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
wine_train$hclust_avg <- as.factor(
cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
str(wine_train)
cutclust_sing <- cutree(hclust_sing, k = 1:10)
cutclust_compl <- cutree(hclust_compl, k= 1:10)
cutclust_avg <- cutree(hclust_avg, k= 1:10)
plot(cutclust_sing)
plot(cutclust_compl)
plot(cutclust_avg)
#create a list of dendgrams
d <- dendlist(
single = dend_sing,
complete = dend_compl,
average = dend_avg)
#cor.dendlist between each clustering result
cor.dendlist(d)
rm(d)
rm(dend_avag)
rm(dend_avg)
rm(dend_compl)
rm(dend_sing)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#cut the dendrograms and bind them to the wine_train dataset
cutclust_sing <- cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_compl <-  cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_avg <-  cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
wine_train$hclust_sing <- as.factor(cutclust_sing)
wine_train$hclust_compl <- as.factor(cutclust_compl)
wine_train$hclust_avg <- as.factor(cutclust_avg)
plot(cutclust_sing)
plot(cutclust_compl)
plot(cutclust_avg)
#create a list of dendgrams
d <- dendlist(
single = dend_sing,
complete = dend_compl,
average = dend_avg)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#cut the dendrograms and bind them to the wine_train dataset
cutclust_sing <- cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_compl <-  cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_avg <-  cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
wine_train$hclust_sing <- as.factor(cutclust_sing)
wine_train$hclust_compl <- as.factor(cutclust_compl)
wine_train$hclust_avg <- as.factor(cutclust_avg)
plot(cutclust_sing)
plot(cutclust_compl)
plot(cutclust_avg)
#create a list of dendgrams
d <- dendlist(
single = cutclust_sing,
complete = cutclust_compl,
average = cutclust_avg)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
class(cutclust_sing)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
head(wine_train)
head(wine_train)
str(wine_train)
class(cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE))
class(cutree(hclust_avg, k = topClust_Wine_Rec[2])
class(cutree(hclust_avg, k = topClust_Wine_Rec[2])
))
class(cutree(hclust_avg, k = topClust_Wine_Rec[2]))
class(hclust_sing)
class(as.dendrogram(hclust_sing))
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#hclust (agglomerative) single
hclust_sing <- hclust( dist(wine_train), method= "single")
dend_sing <- as.dendrogram(hclust_sing)
#hclust complete
hclust_compl <- hclust( dist(wine_train), method= "complete")
dend_compl <- as.dendrogram(hclust_compl)
#hclustaverage methods
hclust_avg <- hclust( dist(wine_train), method= "average")
dend_avg <- as.dendrogram(hclust_avg)
#Create dendogram visualization of all 3
layout(matrix(c(1:3),1,3))
plot(hclust_sing)
plot(hclust_compl)
plot(hclust_avg)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#cut the dendrograms and bind them to the wine_train dataset
cutclust_sing <- cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_compl <-  cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_avg <-  cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
wine_train$hclust_sing <- as.factor(cutclust_sing)
wine_train$hclust_compl <- as.factor(cutclust_compl)
wine_train$hclust_avg <- as.factor(cutclust_avg)
plot(cutclust_sing)
plot(cutclust_compl)
plot(cutclust_avg)
#create a list of dendgrams
d <- dendlist(
single = dend_sing,
complete = dend_compl,
average = dend_avg)
#cor.dendlist between each clustering result
cor.dendlist(d)
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
cor.dendlist(d, "cophenetic")
knitr::opts_chunk$set(echo = TRUE)
library(NbClust)
library(tictoc)
library(beepr)
library(flexclust)
library(corrplot)
library(dendextend)
library(ggplot2)
library(magrittr)
wine <- read.csv("https://github.com/jaewilson07/Hello-World/raw/master/Data%20Mining%20Coursework/Whitewine.csv")
#cut the dendrograms and bind them to the wine_train dataset
cutclust_sing <- cutree(hclust_sing, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_compl <-  cutree(hclust_compl, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
cutclust_avg <-  cutree(hclust_avg, k = topClust_Wine_Rec[2], order_clusters_as_data =  FALSE)
wine_train$hclust_sing <- as.factor(cutclust_sing)
wine_train$hclust_compl <- as.factor(cutclust_compl)
wine_train$hclust_avg <- as.factor(cutclust_avg)
plot(cutclust_sing)
plot(cutclust_compl)
plot(cutclust_avg)
#create a list of dendgrams
d <- dendlist(
single = dend_sing,
complete = dend_compl,
average = dend_avg)
#cor.dendlist between each clustering result
tic("dend")
cor.dendlist(d, "cophenetic")
